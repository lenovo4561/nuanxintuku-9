# 收藏功能实现说明

## 功能概述

已实现完整的收藏功能，包括壁纸和头像的收藏、展示和管理。

## 功能特性

### 1. 收藏操作

- **壁纸收藏**：在 `WallpaperDetail` 页面点击"喜欢"按钮
- **头像收藏**：在 `AvatarDetail` 页面点击"喜欢"按钮
- 收藏状态实时更新，已收藏显示"已喜欢"
- 支持取消收藏功能
- Toast 提示"已添加到收藏"或"已取消收藏"

### 2. 数据存储

使用 localStorage 存储收藏数据：

- **壁纸收藏**：存储 key 为 `wallpaper_favorites`
- **头像收藏**：存储 key 为 `avatar_favorites`

每条收藏数据包含：

```javascript
{
  imageUrl: '',    // 图片地址
  itemId: '',      // 项目ID
  type: '',        // 类型：'wallpaper' 或 'avatar'
  timestamp: 0     // 时间戳，用于排序
}
```

### 3. 收藏页面展示

`Favorites` 页面功能：

- **Tab 切换**：支持在"壁纸"和"头像"之间切换
- **列表展示**：以网格形式展示收藏的图片
- **时间排序**：按收藏时间倒序排列，最新收藏的在前
- **空状态**：没有收藏时显示占位图和提示文字"暂无图片~"
- **点击跳转**：点击收藏项跳转到对应详情页

### 4. 底部导航栏

所有主要页面（壁纸、头像、收藏、我的）都包含统一的底部导航栏：

- 图标和文字标识当前页面
- 支持页面之间快速切换
- 激活状态高亮显示

## 页面文件

### 已实现的页面

1. **Wallpaper (壁纸首页)**

   - 文件：`src/pages/Wallpaper/index.ux`
   - 功能：壁纸分类、最新壁纸列表、底部导航

2. **Avatar (头像首页)**

   - 文件：`src/pages/Avatar/index.ux`
   - 功能：头像分类、最新头像列表、底部导航

3. **WallpaperDetail (壁纸详情)**

   - 文件：`src/pages/WallpaperDetail/index.ux`
   - 功能：壁纸预览、下载、收藏/取消收藏

4. **AvatarDetail (头像详情)**

   - 文件：`src/pages/AvatarDetail/index.ux`
   - 功能：头像预览、下载、收藏/取消收藏

5. **Favorites (收藏页)**

   - 文件：`src/pages/Favorites/index.ux`
   - 功能：收藏列表展示、Tab 切换、跳转详情、底部导航

6. **Mine (我的页面)**
   - 文件：`src/pages/Mine/index.ux`
   - 功能：个人中心、底部导航

## 使用流程

### 收藏流程

1. 在壁纸或头像首页，点击任意图片进入详情页
2. 在详情页点击"喜欢"按钮，图片被添加到收藏
3. 按钮文字变为"已喜欢"，提示"已添加到收藏"
4. 数据自动保存到 localStorage

### 查看收藏

1. 点击底部导航栏的"收藏"图标
2. 默认显示壁纸收藏列表
3. 点击顶部 Tab 可切换到头像收藏
4. 点击任意收藏项可进入详情页

### 取消收藏

1. 在详情页，已收藏的项目显示"已喜欢"
2. 再次点击"喜欢"按钮即可取消收藏
3. 按钮恢复为"喜欢"，提示"已取消收藏"
4. 收藏列表自动更新

## 占位符使用说明

由于目前没有真实的壁纸和头像数据，所有图片都使用占位符：

- 默认图片：`/assets/img/bg.png`
- 空状态图标：`/assets/img/bg.png`（半透明显示）

后续只需替换以下数据源即可显示真实内容：

- `Wallpaper/index.ux` 中的 `wallpaperList`
- `Avatar/index.ux` 中的 `wallpaperList`

## 技术实现

### 核心 API

- `@system.router`：页面路由跳转
- `@system.storage`：本地数据存储
- `@system.prompt`：Toast 提示

### 关键功能

1. **收藏检查**：页面初始化时检查是否已收藏
2. **数据同步**：每次显示收藏页时重新加载数据（`onShow` 生命周期）
3. **状态管理**：使用 `isLiked` 状态控制按钮显示
4. **数组操作**：添加/删除收藏项，排序展示

## 注意事项

1. 所有收藏数据存储在本地，清除应用数据会丢失
2. 图片目前为占位符，需要接入真实数据源
3. 下载功能标记为 TODO，需要后续实现
4. 导航栏使用 `router.replace` 避免路由栈过深
